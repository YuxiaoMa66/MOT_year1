"0","library(tidyverse)"
"0","library(tensorflow)"
"0","library(keras)"
"0","library(dplyr)"
"0",""
"0","# 假设 dta4 已经加载到你的 R 环境中"
"0","# 首先，简单查看数据"
"0",""
"0","# 分割数据集为训练集和测试集"
"0","set.seed(46) # 为了可复现的分割"
"0","train_indices <- sample(seq_len(nrow(dta4)), size = floor(0.8 * nrow(dta4)))"
"0","train_data <- dta4[train_indices, ]"
"0","test_data <- dta4[-train_indices, ]"
"0",""
"0","# 分离特征和标签"
"0","train_labels <- train_data$Satisfaction_dummy"
"0","test_labels <- test_data$Satisfaction_dummy"
"0",""
"0","# 使用 dplyr::select 来确保使用的是 dplyr 包中的函数"
"0","train_data <- dplyr::select(train_data, -Satisfaction_dummy)"
"0","test_data <- dplyr::select(test_data, -Satisfaction_dummy)"
