"0","# Perform PCA on the training data for IV3 variables"
"0","pca_train_data_new <- prcomp(train_data_new[IV3], scale. = TRUE)"
"0",""
"0","# Determine the number of components that explain at least 90% of the variance"
"0","var_explained <- cumsum(pca_train_data_new$sdev^2) / sum(pca_train_data_new$sdev^2)"
"0","num_components <- which(var_explained >= 0.9)[1]"
"0",""
"0","# Transform the training data using the selected number of components"
"0","train_data_new2 <- pca_train_data_new$x[, 1:num_components]"
"0","# Bind the transformed PCA components with the remaining columns and target variable from the training data"
"0","train_data_new2 <- data.frame(train_data_new2, train_data_new[, setdiff(names(train_data_new), IV3)])"
"0",""
"0","# Apply the same PCA transformation to the testing data"
"0","pca_test_data_new_transformed <- predict(pca_train_data_new, newdata = test_data_new[IV3])"
"0","test_data_new2 <- pca_test_data_new_transformed[, 1:num_components]"
"0","# Bind the transformed PCA components with the remaining columns and target variable from the testing data"
"0","test_data_new2 <- data.frame(test_data_new2, test_data_new[, setdiff(names(test_data_new), IV3)])"
"0",""
