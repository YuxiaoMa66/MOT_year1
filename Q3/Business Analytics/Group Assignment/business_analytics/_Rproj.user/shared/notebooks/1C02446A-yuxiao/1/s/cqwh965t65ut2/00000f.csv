"0","# function to compute the importance of the variables"
"0","compute_importance <- function(data, attribute, target) {"
"0",""
"0","  entropy <- function(p) {"
"0","    if (all(p == 0)) return(0) "
"0","    -sum(p * log2(p))"
"0","  }"
"0","  "
"0",""
"0","  gini <- function(p) {"
"0","    1 - sum(p^2)"
"0","  }"
"0","  "
"0",""
"0","  total_entropy <- entropy(table(data[[target]]) / nrow(data))"
"0",""
"0","  total_gini <- gini(table(data[[target]]) / nrow(data))"
"0","  "
"0",""
"0","  weighted_entropy <- 0"
"0","  weighted_gini <- 0"
"0","  split_info <- 0"
"0","  "
"0","  attribute_levels <- unique(data[[attribute]])"
"0","  for (level in attribute_levels) {"
"0","    subset <- data[data[[attribute]] == level,]"
"0","    level_prob <- nrow(subset) / nrow(data)"
"0","    "
"0","    subset_entropy <- entropy(table(subset[[target]]) / nrow(subset))"
"0","    subset_gini <- gini(table(subset[[target]]) / nrow(subset))"
"0","    "
"0","    weighted_entropy <- weighted_entropy + level_prob * subset_entropy"
"0","    weighted_gini <- weighted_gini + level_prob * subset_gini"
"0","    split_info <- split_info + (-level_prob * log2(level_prob))"
"0","  }"
"0","  "
"0","  info_gain <- total_entropy - weighted_entropy"
"0","  gain_ratio <- ifelse(split_info == 0, 0, info_gain / split_info) "
"0","  imp_gini_index <- total_gini - weighted_gini"
"0","  "
"0","  return(list(info_gain = info_gain, gain_ratio = gain_ratio, gini_index = imp_gini_index))"
"0","}"
"0",""
