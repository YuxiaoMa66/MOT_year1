"0","Build_tree_visualize <- function(data, IV, DV, depth, min_obs) {"
"0","  tree <- list()"
"0","  "
"0","  recursive_build <- function(data, IV, DV, depth, min_obs, path = """") {"
"0","    if (nrow(data) < 2*min_obs || depth == 0 || length(IV) == 0) {"
"0","      leaf_avg <- mean(data[[DV]], na.rm = TRUE)"
"0","      return(list(name = paste(path, "", Avg: "", leaf_avg, sep = """"), leaf = TRUE))"
"0","    }"
"0","    "
"0","    selected_var <- if (length(IV) > 1) select_var(data, IV, DV) else IV[1]"
"0","    "
"0","    if (!selected_var %in% names(data)) {"
"0","      return(NULL)"
"0","    }"
"0",""
"0","    left_data <- data[data[[selected_var]] == 0, ]"
"0","    right_data <- data[data[[selected_var]] == 1, ]"
"0",""
"0","    left_node <- recursive_build(left_data, IV[!IV %in% selected_var], DV, depth - 1, min_obs, paste(path, selected_var, ""=0""))"
"0","    right_node <- recursive_build(right_data, IV[!IV %in% selected_var], DV, depth - 1, min_obs, paste(path, selected_var, ""=1""))"
"0",""
"0","    return(list(name = path, children = list(left_node, right_node)))"
"0","  }"
"0",""
"0","  tree <- recursive_build(data, IV, DV, depth, min_obs, ""Root"")"
"0","  return(tree)"
"0","}"
"0",""
"0","leaves <- Build_tree_visualize(train_data, IV2, DV, 4, 2000)"
"0",""
