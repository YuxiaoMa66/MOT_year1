"0","# Function to build the logistic regression model"
"0","library(glmnet)"
"0","library(ggplot2)"
"0",""
"0","train_and_predict_logistic_regression <- function(train_data, test_data, predictor_col) {"
"0",""
"0","  y_train <- train_data[[predictor_col]]"
"0","  x_train <- as.matrix(train_data[, setdiff(names(train_data), predictor_col)])"
"0","  y_test <- test_data[[predictor_col]]"
"0","  x_test <- as.matrix(test_data[, setdiff(names(test_data), predictor_col)])"
"0",""
"0",""
"0","  cv_fit <- cv.glmnet(x_train, y_train, family = ""binomial"", alpha = seq(0, 1, 0.1))"
"0","  "
"0",""
"0","  predictions <- predict(cv_fit, newx = x_test, type = ""class"", s = ""lambda.min"")"
"0","  "
"0",""
"0","  accuracy <- mean(predictions == y_test)"
"0",""
"0","  list(accuracy = accuracy, lambda = cv_fit$lambda.min, alpha = cv_fit$alpha)"
"0","}"
"0",""
"0",""
