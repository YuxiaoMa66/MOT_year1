"0","# Function to adjust the path for the testing data"
"0","# 改进的函数，以确保正确分割测试数据"
"0","split_test_data_improved <- function(test_data, leaves_data) {"
"0","  split_datasets <- list()"
"0","  "
"0","  # 遍历每个叶节点的路径条件"
"0","  for (leaf_index in seq_along(leaves_data)) {"
"0","    path_conditions <- leaves_data[[leaf_index]]$path"
"0","    subset_data <- test_data"
"0","    "
"0","    # 对于每个路径条件，分别应用这些条件来筛选数据"
"0","    for (condition in path_conditions) {"
"0","      # 解析条件"
"0","      parts <- strsplit(condition, "" = "")[[1]]"
"0","      variable <- parts[1]"
"0","      value <- as.numeric(parts[2])"
"0","      "
"0","      # 应用条件进行数据筛选"
"0","      subset_data <- subset(subset_data, subset_data[[variable]] == value)"
"0","    }"
"0","    "
"0","    # 将筛选后的数据集添加到列表中"
"0","    split_datasets[[leaf_index]] <- subset_data"
"0","  }"
"0","  "
"0","  return(split_datasets)"
"0","}"
"0",""
