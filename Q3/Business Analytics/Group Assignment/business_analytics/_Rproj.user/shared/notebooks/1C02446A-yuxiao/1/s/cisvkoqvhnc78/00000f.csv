"0","# PCA on the traning data"
"0","pca_train_data_new <- prcomp(train_data_new[, setdiff(names(train_data_new), ""Satisfaction_dummy"")], scale. = TRUE)"
"0",""
"0","# keep the number of components that explain at least 90% of the variance"
"0","var_explained <- cumsum(pca_train_data_new$sdev^2) / sum(pca_train_data_new$sdev^2)"
"0","num_components <- which(var_explained >= 0.9)[1]"
"0",""
"0","# use the number of components to transform the training data"
"0","train_data_new2 <- pca_train_data_new$x[, 1:num_components]"
"0","train_data_new2 <- cbind(train_data_new2, Satisfaction_dummy = train_data_new$Satisfaction_dummy)"
"0",""
"0","# use the same PCA model to transform the testing data in case the number of components is different and the transformation is different"
"0","pca_test_data_new_transformed <- predict(pca_train_data_new, newdata = test_data_new[, setdiff(names(test_data_new), ""Satisfaction_dummy"")])"
"0","test_data_new2 <- pca_test_data_new_transformed[, 1:num_components]"
"0","test_data_new2 <- cbind(test_data_new2, Satisfaction_dummy = test_data_new$Satisfaction_dummy)"
"0",""
